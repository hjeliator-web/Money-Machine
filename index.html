<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Money Machine</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body{
 margin:0;
 background:linear-gradient(#6ec6ff,#e0f7fa);
 font-family:Arial;
 text-align:center;
}
canvas{
 background:linear-gradient(#9adfff,#ffffff);
 border-radius:12px;
 border:3px solid #222;
 display:block;
 margin:auto;
}
#hud{
 font-size:16px;
 font-weight:bold;
 padding:6px;
}
button{
 padding:8px 14px;
 margin:3px;
 font-size:15px;
 border-radius:8px;
}
</style>
</head>

<body>

<div id="hud">ğŸª™ 0 | â­ 1 | ğŸ”« Lv1</div>
<canvas id="game" width="360" height="480"></canvas>

<div>
<button onclick="shoot()">ğŸ”« Shoot</button>
<button onclick="shop()">ğŸ›’ Shop</button>
<button onclick="missions()">ğŸ¯ Missions</button>
<button onclick="leaderboard()">ğŸ† Rank</button>
</div>

<script>
Telegram.WebApp.expand();

const c=document.getElementById("game");
const x=c.getContext("2d");

let coins=Number(localStorage.coins||0);
let level=Number(localStorage.level||1);
let gun=Number(localStorage.gun||1);
let kills=Number(localStorage.kills||0);
let skin=localStorage.skin||"ğŸ§‘â€ğŸš€";

let bullets=[];
let clouds=[{x:0,y:40},{x:150,y:70},{x:300,y:50}];

let plane={x:-80,y:80,alive:true,boss:false};

let bots=[
 {name:"Ali",coins:200},
 {name:"Ahmed",coins:150},
 {name:"John",coins:180},
 {name:"Max",coins:220}
];

function save(){
 localStorage.coins=coins;
 localStorage.level=level;
 localStorage.gun=gun;
 localStorage.kills=kills;
 localStorage.skin=skin;
}

function hud(){
 document.getElementById("hud").innerText=
 `ğŸª™ ${coins} | â­ ${level} | ğŸ”« Lv${gun}`;
}

function shoot(){
 bullets.push({x:180,y:420});
}

function shop(){
 if(coins>=100){
  coins-=100; gun++;
  alert("Gun upgraded!");
  save(); hud();
 }else alert("Need 100 coins");
}

function missions(){
 alert(
 "ğŸ¯ MISSIONS\n"+
 "1ï¸âƒ£ Shoot 5 planes = +50 coins\n"+
 "2ï¸âƒ£ Defeat boss = +100 coins\n"+
 "3ï¸âƒ£ Reach level 5"
 );
}

function leaderboard(){
 let all=[{name:"YOU",coins:coins},...bots];
 all.sort((a,b)=>b.coins-a.coins);
 let text="ğŸ† LEADERBOARD\n";
 all.slice(0,5).forEach((p,i)=>{
  text+=`${i+1}. ${p.name} - ${p.coins}\n`;
 });
 alert(text);
}

function spawnPlane(){
 plane.alive=true;
 plane.x=-80;
 plane.y=60+Math.random()*100;
 plane.boss = level%5===0;
}

spawnPlane(); hud();

function loop(){
 x.clearRect(0,0,360,480);

 // clouds
 x.font="28px Arial";
 clouds.forEach(cl=>{
  cl.x+=0.3;
  if(cl.x>380) cl.x=-50;
  x.fillText("â˜ï¸",cl.x,cl.y);
 });

 // ground
 x.fillStyle="#4caf50";
 x.fillRect(0,440,360,40);

 // player
 x.font="30px Arial";
 x.fillText(skin,165,420);

 // plane
 if(plane.alive){
  plane.x+=2+level/2;
  x.font=plane.boss?"40px Arial":"30px Arial";
  x.fillText(plane.boss?"ğŸ›©ï¸":"âœˆï¸",plane.x,plane.y);
  if(plane.x>380) spawnPlane();
 }

 // bullets
 for(let i=bullets.length-1;i>=0;i--){
  bullets[i].y-=6+gun;
  x.font="20px Arial";
  x.fillText("ğŸ”¥",bullets[i].x,bullets[i].y);

  if(plane.alive &&
     bullets[i].y<plane.y+30 &&
     bullets[i].x>plane.x &&
     bullets[i].x<plane.x+40){

    plane.alive=false;
    kills++;
    coins+=plane.boss?80:15;
    if(kills%5===0) level++;
    save(); hud();
    setTimeout(spawnPlane,800);
    bullets.splice(i,1);
  }

  if(bullets[i] && bullets[i].y<0) bullets.splice(i,1);
 }

 requestAnimationFrame(loop);
}
loop();

 let tg = Telegram.WebApp;
let user = tg.initDataUnsafe.user;
let username = user?.first_name || "Player";

</script>

</body>
</html>
