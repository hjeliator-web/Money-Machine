<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Money Machine</title>
<style>
body{margin:0;background:#000;color:#fff;font-family:Arial;overflow:hidden}
#ui{position:fixed;top:5px;left:5px;z-index:10}
button{padding:6px;margin:2px;font-size:13px}
canvas{background:#111;display:block;margin:auto}
.menu{
 position:fixed;top:50%;left:50%;
 transform:translate(-50%,-50%);
 background:#222;padding:15px;
 border:2px solid #555;display:none
}
select,input{width:100%}
</style>
</head>

<body>

<div id="ui">
 <div id="hud"></div>
 <button onclick="shoot()">ğŸ”¥ Shoot</button>
 <button onclick="openShop()">ğŸ›’ Shop</button>
 <button onclick="openSettings()">âš™ï¸</button>
 <button onclick="dailyReward()">ğŸ</button><br>
 <button onclick="move(-1)">â¬…</button>
 <button onclick="move(1)">â¡</button>
</div>

<canvas id="game" width="360" height="600"></canvas>

<div id="shop" class="menu">
 <h3>ğŸ›’ Shop</h3>
 <button onclick="watchAd('speed')">âš¡ Speed (1 Ad)</button><br>
 <button onclick="watchAd('life')">â¤ï¸ Extra Life (2 Ads)</button>
 <p id="adStatus"></p>
 <button onclick="closeShop()">Close</button>
</div>

<div id="settings" class="menu">
 <h3>âš™ï¸ Settings</h3>
 Sensitivity
 <input type="range" min="1" max="10" value="5"
 oninput="sensitivity=this.value"><br><br>

 Player Skin
 <select onchange="setSkin(this.value)">
  <option value="cyan">Cyan</option>
  <option value="red">Red</option>
  <option value="lime">Green</option>
 </select><br><br>

 <button onclick="closeSettings()">Close</button>
</div>

<div id="gameover" class="menu">
 <h2>ğŸ’€ GAME OVER</h2>
 <div id="leaderboard"></div><br>
 <button onclick="restart()">ğŸ”„ Restart</button>
</div>

<!-- Sounds -->
<audio id="sndShoot" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
<audio id="sndHit" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="sndOver" src="https://actions.google.com/sounds/v1/cartoon/boing.ogg"></audio>

<script>
const c=document.getElementById("game");
const ctx=c.getContext("2d");

let data=JSON.parse(localStorage.getItem("moneyMachine"))||{
 coins:0,lives:3,level:1,speed:6,skin:"cyan"
};

let player={x:160,y:520,w:30,h:30};
let bullets=[],enemies=[];
let coins=data.coins,lives=data.lives,level=data.level;
let speed=data.speed,sensitivity=5;
let skin=data.skin;
let game=true,boss=false;
let ads={speed:0,life:0};

function save(){
 localStorage.setItem("moneyMachine",JSON.stringify({
  coins,lives,level,speed,skin
 }));
}

function hud(){
 document.getElementById("hud").innerText=
 `ğŸ’°${coins} â¤ï¸${lives} ğŸ”¥ Level ${level}`;
 save();
}
hud();

function shoot(){
 bullets.push({x:player.x+12,y:player.y});
 sndShoot.play();
}

function move(d){
 player.x+=d*speed*(sensitivity/5);
 player.x=Math.max(0,Math.min(330,player.x));
}

document.onkeydown=e=>{
 if(e.key=="ArrowLeft"||e.key=="a")move(-1);
 if(e.key=="ArrowRight"||e.key=="d")move(1);
 if(e.key==" ")shoot();
};

function spawnEnemy(){
 let t=Math.random();
 enemies.push({
  x:Math.random()*330,y:-30,
  size:t>0.85?40:25,
  hp:t>0.85?6:2,
  speed:2+level*0.15,boss:false
 });
}

function spawnBoss(){
 enemies.push({x:80,y:-100,size:100,hp:80,speed:1,boss:true});
}

function update(){
 if(!game)return;
 ctx.clearRect(0,0,360,600);

 ctx.fillStyle=skin;
 ctx.fillRect(player.x,player.y,player.w,player.h);

 bullets.forEach((b,i)=>{
  b.y-=12;
  ctx.fillStyle="yellow";
  ctx.fillRect(b.x,b.y,5,10);
  if(b.y<0)bullets.splice(i,1);
 });

 enemies.forEach((e,ei)=>{
  e.y+=e.speed;
  ctx.fillStyle=e.boss?"purple":"orange";
  ctx.fillRect(e.x,e.y,e.size,e.size);

  bullets.forEach((b,bi)=>{
   if(b.x<e.x+e.size&&b.x+5>e.x&&b.y<e.y+e.size&&b.y+10>e.y){
    e.hp--; bullets.splice(bi,1);
    sndHit.play();
    if(e.hp<=0){
     coins+=e.boss?150:5;
     enemies.splice(ei,1);
     if(e.boss){boss=false;level++;}
    }
   }
  });

  if(e.y>600){
   enemies.splice(ei,1);
   lives--;
   if(lives<=0)endGame();
  }
 });

 if(!boss && Math.random()<0.02)spawnEnemy();
 if(level==10 && !boss){boss=true;spawnBoss();}
 if(coins>level*60 && !boss)level++;

 hud();
 requestAnimationFrame(update);
}
update();

function endGame(){
 game=false;
 sndOver.play();
 saveScore();
 showLeaderboard();
 gameover.style.display="block";
}

function restart(){location.reload();}

function saveScore(){
 let lb=JSON.parse(localStorage.getItem("leaderboard"))||[];
 lb.push({score:coins,date:new Date().toLocaleDateString()});
 lb.sort((a,b)=>b.score-a.score);
 lb=lb.slice(0,5);
 localStorage.setItem("leaderboard",JSON.stringify(lb));
}

function showLeaderboard(){
 let lb=JSON.parse(localStorage.getItem("leaderboard"))||[];
 leaderboard.innerHTML="<h3>ğŸ† Leaderboard</h3>"+
 lb.map(e=>`ğŸ’° ${e.score} (${e.date})`).join("<br>");
}

function openShop(){shop.style.display="block";}
function closeShop(){shop.style.display="none";}
function openSettings(){settings.style.display="block";}
function closeSettings(){settings.style.display="none";}

function setSkin(s){skin=s;save();}

function dailyReward(){coins+=20;alert("ğŸ +20 Coins");hud();}

function watchAd(type){
 let need=type=="speed"?1:2;
 adStatus.innerText="Watching ad...";
 setTimeout(()=>{
  ads[type]++;
  if(ads[type]>=need){
   ads[type]=0;
   if(type=="speed")speed+=2;
   if(type=="life")lives++;
   adStatus.innerText="âœ… Reward unlocked";
   hud();
  }else adStatus.innerText=`Watch ${need-ads[type]} more ads`;
 },5000);
}
</script>

</body>
</html>
